{"title":"打卡.py","uid":"d3cfa19866726aa8d161390b7e40cbcf","slug":"打卡-py","date":"2022-01-31T11:27:08.000Z","updated":"2022-01-31T11:27:46.131Z","comments":true,"path":"api/articles/打卡-py.json","keywords":null,"cover":null,"content":"<pre class=\"line-numbers language-python\" data-language=\"python\"><code class=\"language-python\"><span class=\"token comment\">#pip install pymouse</span>\n<span class=\"token comment\">#pip install pyUserInput</span>\n<span class=\"token comment\">#pip install pyperclip</span>\n<span class=\"token comment\">#pip install pyinstaller</span>\n<span class=\"token comment\">#pip install pyhook3</span>\n\n\n<span class=\"token keyword\">import</span> time\n<span class=\"token keyword\">import</span> tkinter <span class=\"token keyword\">as</span> tk\n<span class=\"token keyword\">from</span> tkinter <span class=\"token keyword\">import</span> ttk<span class=\"token punctuation\">,</span> messagebox <span class=\"token keyword\">as</span> msg\n<span class=\"token keyword\">import</span> pymouse<span class=\"token punctuation\">,</span> pykeyboard<span class=\"token punctuation\">,</span> pyperclip\n\n\n\n<span class=\"token comment\"># 创建用户窗口</span>\nmainForm <span class=\"token operator\">=</span> tk<span class=\"token punctuation\">.</span>Tk<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\nmainForm<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">(</span><span class=\"token string\">'自动群发系统'</span><span class=\"token punctuation\">)</span>\nmainForm<span class=\"token punctuation\">.</span>resizable<span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 输入框，用于输入要群发的用户名</span>\nnameText <span class=\"token operator\">=</span> tk<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">(</span>mainForm<span class=\"token punctuation\">,</span> height<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\nnameText<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"在此处键入需要群发消息的名单\"</span><span class=\"token punctuation\">)</span>\nnameText<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> padx<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> pady<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmsgText <span class=\"token operator\">=</span> tk<span class=\"token punctuation\">.</span>Text<span class=\"token punctuation\">(</span>mainForm<span class=\"token punctuation\">,</span> height<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">)</span>\nmsgText<span class=\"token punctuation\">.</span>insert<span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"在此处键入群发的内容哦哦哦\"</span><span class=\"token punctuation\">)</span>\nmsgText<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> padx<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> pady<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmouseSearchXY <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\nmouseInputXY <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">onClickMouseButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">global</span> mouseSearchXY<span class=\"token punctuation\">,</span> mouseInputXY\n    m <span class=\"token operator\">=</span> pymouse<span class=\"token punctuation\">.</span>PyMouse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    msg<span class=\"token punctuation\">.</span>showinfo<span class=\"token punctuation\">(</span><span class=\"token string\">'提示'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'请在点击确认后2秒内将鼠标移动到QQ的搜索框，2秒后自动获取搜索框鼠标位置。'</span><span class=\"token punctuation\">)</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    mouseSearchXY <span class=\"token operator\">=</span> m<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    msg<span class=\"token punctuation\">.</span>showinfo<span class=\"token punctuation\">(</span><span class=\"token string\">'成功'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'成功，请在点击确认后2秒内将鼠标移动到QQ的输入框，2秒后自动获取输入框鼠标位置。'</span><span class=\"token punctuation\">)</span>\n    time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n    mouseInputXY <span class=\"token operator\">=</span> m<span class=\"token punctuation\">.</span>position<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    msg<span class=\"token punctuation\">.</span>showinfo<span class=\"token punctuation\">(</span><span class=\"token string\">'成功'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'任务成功完成'</span><span class=\"token punctuation\">)</span>\n\n\nmouseButton <span class=\"token operator\">=</span> ttk<span class=\"token punctuation\">.</span>Button<span class=\"token punctuation\">(</span>mainForm<span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string\">'点击获取鼠标位置'</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> command<span class=\"token operator\">=</span>onClickMouseButton<span class=\"token punctuation\">)</span>\nmouseButton<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> padx<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> pady<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token keyword\">def</span> <span class=\"token function\">onClickStartButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token comment\"># 判断是否已经读取鼠标位置</span>\n    <span class=\"token keyword\">if</span> mouseSearchXY <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">or</span> mouseInputXY <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        msg<span class=\"token punctuation\">.</span>showerror<span class=\"token punctuation\">(</span><span class=\"token string\">'错误'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'请先获取鼠标位置哦哦哦'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span>\n    <span class=\"token comment\"># 判断输入框有没有内容</span>\n    nameContent <span class=\"token operator\">=</span> nameText<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> tk<span class=\"token punctuation\">.</span>END<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> nameContent <span class=\"token operator\">==</span> <span class=\"token string\">'在此处键入需要群发消息的名单'</span> <span class=\"token keyword\">or</span> nameContent <span class=\"token operator\">==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">:</span>\n        msg<span class=\"token punctuation\">.</span>showerror<span class=\"token punctuation\">(</span><span class=\"token string\">'错误'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'请先输入名单哦哦哦'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span>\n    msgContent <span class=\"token operator\">=</span> msgText<span class=\"token punctuation\">.</span>get<span class=\"token punctuation\">(</span><span class=\"token number\">0.0</span><span class=\"token punctuation\">,</span> tk<span class=\"token punctuation\">.</span>END<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>rstrip<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">if</span> msgContent <span class=\"token operator\">==</span> <span class=\"token string\">'在此处键入群发的内容哦哦哦'</span> <span class=\"token keyword\">or</span> msgContent <span class=\"token operator\">==</span> <span class=\"token string\">''</span><span class=\"token punctuation\">:</span>\n        msg<span class=\"token punctuation\">.</span>showerror<span class=\"token punctuation\">(</span><span class=\"token string\">'错误'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'请先输入群发的内容哦哦哦'</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">return</span>\n    <span class=\"token comment\"># 开始群发</span>\n    <span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> msg<span class=\"token punctuation\">.</span>askokcancel<span class=\"token punctuation\">(</span><span class=\"token string\">'提示'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'开始干活喽，在我说完成之前别动鼠标哦'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        <span class=\"token keyword\">return</span>\n    m <span class=\"token operator\">=</span> pymouse<span class=\"token punctuation\">.</span>PyMouse<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取鼠标对象</span>\n    k <span class=\"token operator\">=</span> pykeyboard<span class=\"token punctuation\">.</span>PyKeyboard<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>  <span class=\"token comment\"># 获取键盘对象</span>\n    lst <span class=\"token operator\">=</span> nameContent<span class=\"token punctuation\">.</span>split<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">for</span> i <span class=\"token keyword\">in</span> lst<span class=\"token punctuation\">:</span>\n        m<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span>mouseSearchXY<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> mouseSearchXY<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        pyperclip<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span>i<span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>press_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>control_key<span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>tap_key<span class=\"token punctuation\">(</span><span class=\"token string\">'v'</span><span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>release_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>control_key<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>tap_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>enter_key<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>tap_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>enter_key<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n        m<span class=\"token punctuation\">.</span>click<span class=\"token punctuation\">(</span>mouseInputXY<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> mouseInputXY<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        pyperclip<span class=\"token punctuation\">.</span>copy<span class=\"token punctuation\">(</span>msgContent<span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>press_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>control_key<span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>tap_key<span class=\"token punctuation\">(</span><span class=\"token string\">'v'</span><span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>release_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>control_key<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n        k<span class=\"token punctuation\">.</span>tap_key<span class=\"token punctuation\">(</span>k<span class=\"token punctuation\">.</span>enter_key<span class=\"token punctuation\">)</span>\n        time<span class=\"token punctuation\">.</span>sleep<span class=\"token punctuation\">(</span><span class=\"token number\">0.5</span><span class=\"token punctuation\">)</span>\n    msg<span class=\"token punctuation\">.</span>showinfo<span class=\"token punctuation\">(</span><span class=\"token string\">'提示'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'任务成功完成！'</span><span class=\"token punctuation\">)</span>\n\n\nstartButton <span class=\"token operator\">=</span> ttk<span class=\"token punctuation\">.</span>Button<span class=\"token punctuation\">(</span>mainForm<span class=\"token punctuation\">,</span> text<span class=\"token operator\">=</span><span class=\"token string\">'启动'</span><span class=\"token punctuation\">,</span> width<span class=\"token operator\">=</span><span class=\"token number\">40</span><span class=\"token punctuation\">,</span> command<span class=\"token operator\">=</span>onClickStartButton<span class=\"token punctuation\">)</span>\nstartButton<span class=\"token punctuation\">.</span>grid<span class=\"token punctuation\">(</span>row<span class=\"token operator\">=</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> padx<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">,</span> pady<span class=\"token operator\">=</span><span class=\"token number\">5</span><span class=\"token punctuation\">)</span>\n\nmainForm<span class=\"token punctuation\">.</span>mainloop<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n","feature":true,"text":"#pip install pymouse #pip install pyUserInput #pip install pyperclip #pip install pyinstaller #pip install pyhook3 import time import tkinte...","link":"","photos":[],"count_time":{"symbolsCount":"2.6k","symbolsTime":"2 mins."},"categories":[],"tags":[{"name":"应用程序","slug":"应用程序","count":1,"path":"api/tags/应用程序.json"}],"toc":"","author":{"name":"硕硕一只","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fhbimg.huabanimg.com%2F80d6d8c3ba2f7b0b2d6f11ca3aeb3282b0e5e6db4440d-hBmm8H_fw658&refer=http%3A%2F%2Fhbimg.huabanimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1640525060&t=3e93c392bb08daa019a7de3fc6da319b","link":"https://zhaoyushuo123.github.io","description":"欢迎来到我的个人博客，本博客以记录链接网址为主，知识内容为辅，禁止他人转载知识内容。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"mapped":true,"prev_post":{"title":"postgresql安装问题","uid":"6ab9212b4fb6200d52bba6e14c9ca630","slug":"postgresql安装问题","date":"2022-02-04T05:47:48.000Z","updated":"2022-02-04T05:51:46.710Z","comments":true,"path":"api/articles/postgresql安装问题.json","keywords":null,"cover":null,"text":"postgresql安装问题坑有很多，大致分为三大类： 1.用户权限问题，postgresql安装时需要在windows下创建新的名为postgres的用户 2.版本问题，截至2022/2/4；windows10建议安装postgresql13版本而不用14版本 3.路径/环境变...","link":"","photos":[],"count_time":{"symbolsCount":524,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"postgresql","slug":"postgresql","count":1,"path":"api/tags/postgresql.json"}],"author":{"name":"硕硕一只","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fhbimg.huabanimg.com%2F80d6d8c3ba2f7b0b2d6f11ca3aeb3282b0e5e6db4440d-hBmm8H_fw658&refer=http%3A%2F%2Fhbimg.huabanimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1640525060&t=3e93c392bb08daa019a7de3fc6da319b","link":"https://zhaoyushuo123.github.io","description":"欢迎来到我的个人博客，本博客以记录链接网址为主，知识内容为辅，禁止他人转载知识内容。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}},"feature":true},"next_post":{"title":"windows下配置c++环境","uid":"42843c56f5b9a2127c8afd31e855e535","slug":"windows下配置c-环境","date":"2022-01-27T12:23:45.000Z","updated":"2022-01-27T12:25:46.453Z","comments":true,"path":"api/articles/windows下配置c-环境.json","keywords":null,"cover":null,"text":"gcc—-&gt;c—&gt;.cg++—-?c++–&gt;.cpp这个链接下很详细https://blog.csdn.net/justidle/article/details/105845768可参考https://code.visualstudio.com/docs/cpp...","link":"","photos":[],"count_time":{"symbolsCount":154,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"windows","slug":"windows","count":7,"path":"api/tags/windows.json"},{"name":"vscode","slug":"vscode","count":1,"path":"api/tags/vscode.json"},{"name":"c/c++","slug":"c-c","count":1,"path":"api/tags/c-c.json"}],"author":{"name":"硕硕一只","slug":"blog-author","avatar":"https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fhbimg.huabanimg.com%2F80d6d8c3ba2f7b0b2d6f11ca3aeb3282b0e5e6db4440d-hBmm8H_fw658&refer=http%3A%2F%2Fhbimg.huabanimg.com&app=2002&size=f9999,10000&q=a80&n=0&g=0n&fmt=jpeg?sec=1640525060&t=3e93c392bb08daa019a7de3fc6da319b","link":"https://zhaoyushuo123.github.io","description":"欢迎来到我的个人博客，本博客以记录链接网址为主，知识内容为辅，禁止他人转载知识内容。","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{}}}}}